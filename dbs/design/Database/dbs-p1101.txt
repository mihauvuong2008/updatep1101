/* AUTHOR: NGOCDONGDEPTRAI */

-- CREATE DATABASE
-- CREATE DATABASE QUANLYPTTS;

-- CREATE TABLE 
CREATE TABLE TAPHOSO
(
	MA_TAPHOSO                    	INTEGER NOT NULL AUTO_INCREMENT,
	TEN_TAPHOSO                   	VARCHAR(150),
	GIOITHIEU_TAPHOSO           	VARCHAR(300),
	NGAY_TAO_TAPHOSO  				DATE,
	CONSTRAINT PRIMARY KEY(MA_TAPHOSO) 
)ENGINE=InnoDB;

CREATE TABLE VANBAN
(
	MA_VANBAN                    	INTEGER NOT NULL AUTO_INCREMENT,
	SO_VANBAN 						VARCHAR(150),
	NGAY_BAN_HANH 					DATE,
	CO_QUAN_BAN_HANH              	VARCHAR(150),
	TRICH_YEU            			VARCHAR(300), 
	MA_TAPHOSO                    	INTEGER NOT NULL,
	CONSTRAINT FOREIGN KEY (MA_TAPHOSO) REFERENCES TAPHOSO(MA_TAPHOSO) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT  PRIMARY KEY(MA_VANBAN) 
)ENGINE=InnoDB;

create table FILESCAN (
    image_id         INTEGER NOT NULL AUTO_INCREMENT,
    image            LONGBLOB        not null,
    image_size       varchar(25) not null default '',
    image_name       varchar(150) not null default '',
    Ngaytao 	     DATE,
	Stt  			 INTEGER default '0',
	MA_VANBAN        INTEGER NOT NULL,
	CONSTRAINT FOREIGN KEY (MA_VANBAN) REFERENCES VANBAN(MA_VANBAN) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT PRIMARY KEY(image_id) 
);
 
 
CREATE TABLE NHOMTAISAN_CAP_I
 ( 
		MA_NHOMTAISAN_CAP_I 			INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_NHOMTAISAN_CAP_I 			VARCHAR(350),
 		CONSTRAINT PRIMARY KEY(MA_NHOMTAISAN_CAP_I)
 	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;

CREATE TABLE NHOMTAISAN_CAP_II
( 
	MA_NHOMTAISAN_CAP_II 			INTEGER(10) NOT NULL AUTO_INCREMENT,
	TEN_NHOMTAISAN_CAP_II 			VARCHAR(350),
	MA_NHOMTAISAN_CAP_I 			INTEGER(10) NOT NULL,
	CONSTRAINT PRIMARY KEY(MA_NHOMTAISAN_CAP_II),
	CONSTRAINT FOREIGN KEY (MA_NHOMTAISAN_CAP_I) REFERENCES NHOMTAISAN_CAP_I(MA_NHOMTAISAN_CAP_I) ON DELETE CASCADE ON UPDATE CASCADE
)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;

CREATE TABLE NHOMTAISAN_CAP_III
 ( 
		MA_NHOMTAISAN_CAP_III 			INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_NHOMTAISAN_CAP_III 			VARCHAR(350),
		MA_NHOMTAISAN_CAP_II 			INTEGER(10) NOT NULL,
 		CONSTRAINT PRIMARY KEY(MA_NHOMTAISAN_CAP_III),
		CONSTRAINT FOREIGN KEY (MA_NHOMTAISAN_CAP_II) REFERENCES NHOMTAISAN_CAP_II(MA_NHOMTAISAN_CAP_II) ON DELETE CASCADE ON UPDATE CASCADE
 	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
 
CREATE TABLE NHOMTAISAN_CAP_IV
 ( 
		MA_NHOMTAISAN_CAP_IV 			INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_NHOMTAISAN_CAP_IV 			VARCHAR(350),
		MA_NHOMTAISAN_CAP_III 			INTEGER(10) NOT NULL,
 		CONSTRAINT PRIMARY KEY(MA_NHOMTAISAN_CAP_IV),
		CONSTRAINT FOREIGN KEY (MA_NHOMTAISAN_CAP_III) REFERENCES NHOMTAISAN_CAP_III(MA_NHOMTAISAN_CAP_III) ON DELETE CASCADE ON UPDATE CASCADE
 	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
 
CREATE TABLE NHOMTAISAN_CAP_V
 ( 
		MA_NHOMTAISAN_CAP_V 			INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_NHOMTAISAN_CAP_V 			VARCHAR(350),
		MA_NHOMTAISAN_CAP_IV 			INTEGER(10) NOT NULL,
		THOIGIAN_SUDUNG  				INTEGER(10),
		TILE_HAOMON  					DOUBLE,
 		CONSTRAINT PRIMARY KEY(MA_NHOMTAISAN_CAP_V),
		CONSTRAINT FOREIGN KEY (MA_NHOMTAISAN_CAP_IV) REFERENCES NHOMTAISAN_CAP_IV(MA_NHOMTAISAN_CAP_IV) ON DELETE CASCADE ON UPDATE CASCADE
 	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
 
 
CREATE TABLE LOAITAISAN_CAP_I
 ( 
		MA_LOAITAISAN_CAP_I 			INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_LOAITAISAN_CAP_I  			VARCHAR(350),
		CONSTRAINT PMK_LOAITAISAN PRIMARY KEY(MA_LOAITAISAN_CAP_I) 
 )ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
 
CREATE TABLE LOAITAISAN_CAP_II
 ( 
		MA_LOAITAISAN_CAP_II  			INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_LOAITAISAN_CAP_II  			VARCHAR(350),
		MA_LOAITAISAN_CAP_I 			INTEGER(10),
		CONSTRAINT PRIMARY KEY(MA_LOAITAISAN_CAP_II),
		CONSTRAINT FOREIGN KEY (MA_LOAITAISAN_CAP_I) REFERENCES LOAITAISAN_CAP_I(MA_LOAITAISAN_CAP_I) ON DELETE CASCADE ON UPDATE CASCADE
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
 
CREATE TABLE LOAITAISAN_CAP_III
 ( 
		MA_LOAITAISAN_CAP_III 		INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_LOAITAISAN_CAP_III 	VARCHAR(350),
		MA_LOAITAISAN_CAP_II 			INTEGER(10),
		CONSTRAINT PRIMARY KEY(MA_LOAITAISAN_CAP_III),
		CONSTRAINT FOREIGN KEY (MA_LOAITAISAN_CAP_II) REFERENCES LOAITAISAN_CAP_II(MA_LOAITAISAN_CAP_II) ON DELETE CASCADE ON UPDATE CASCADE
 )ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
 
 
 CREATE TABLE PHONGBAN
 ( 
		MA_PHONGBAN 				INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_PHONGBAN 				VARCHAR(35),
		GIOI_THIEU_PHONGBAN 		VARCHAR(150),
		CONSTRAINT PRIMARY KEY(MA_PHONGBAN)
)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
 
CREATE TABLE TAISAN
 ( 
		MA_TAISAN 					INTEGER(15) NOT NULL AUTO_INCREMENT,
		CONSTRAINT 					PRIMARY KEY(MA_TAISAN),
		TEN_TAISAN 					VARCHAR(300) NOT NULL,
		MODEL 						VARCHAR(150) ,
		SERI 						VARCHAR(150) NULL,
		NGAY_SU_DUNG 				DATE,
		XUAT_XU 					VARCHAR(50),
		BAO_HANH 					VARCHAR(50),
		TINH_TRANG 					INTEGER(5) DEFAULT 1,-- 1: moi; 2: tot; 3 trung binh; 4: kem; 5: khong su dung dc
		TRANG_THAI 					INTEGER(5) DEFAULT 1,-- 1: dang su dung; 2: kho; 3 da ban giao
		DON_VI_TINH 				VARCHAR(15),
		SOLUONG   					INTEGER,
		NGUYEN_GIA 					BIGINT ,
		GHI_CHU 					VARCHAR(240),
		MA_TANSAN_KETOAN 			VARCHAR(20) UNIQUE ,
		MA_NHOMTAISAN_CAP_V   			INTEGER(10),
		MA_LOAITAISAN_CAP_III  			INTEGER(10),
		MA_DON_VI_SU_DUNG 			INTEGER(10),
		MA_DON_VI_QUAN_LY 			INTEGER(10),
		 
		CONSTRAINT FOREIGN KEY (MA_NHOMTAISAN_CAP_V) REFERENCES NHOMTAISAN_CAP_V(MA_NHOMTAISAN_CAP_V),
		CONSTRAINT FOREIGN KEY (MA_LOAITAISAN_CAP_III) REFERENCES LOAITAISAN_CAP_III(MA_LOAITAISAN_CAP_III),
		CONSTRAINT FOREIGN KEY (MA_DON_VI_SU_DUNG) REFERENCES PHONGBAN(MA_PHONGBAN),
		CONSTRAINT FOREIGN KEY (MA_DON_VI_QUAN_LY) REFERENCES PHONGBAN(MA_PHONGBAN)
		 
 )ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	
CREATE TABLE PHUKIEN
 ( 
		MA_PHUKIEN 				INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_PHUKIEN 			VARCHAR(150) NOT NULL,
		MODEL 					VARCHAR(40),
		SERI 					VARCHAR(40),
		NGUYEN_GIA 				INTEGER,
		MA_TAISAN 				INTEGER(15),
		CONSTRAINT FOREIGN KEY (MA_TAISAN) REFERENCES TAISAN(MA_TAISAN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT PRIMARY KEY(MA_PHUKIEN)
 )ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
 
CREATE TABLE LOAI_XE
(
		MA_LOAI_XE 		 		INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_DONG_XE   			VARCHAR(40),
		HANG_SAN_XUAT   		VARCHAR (40),
		OTO_XEMAY   	  		INTEGER,
		DINH_MUC_XANG_DAU  		DOUBLE,
		THAY_NHOT 					INTEGER default 0,
		THAY_LOC_NHOT 				INTEGER default 0,
		THAY_LOC_GIO 				INTEGER default 0,
		THAY_LOC_NHIEN_LIEU  		INTEGER default 0,
		THAY_DAU_PHANH_DAU_LY_HOP  	INTEGER default 0,
		THAY_DAU_HOP_SO  			INTEGER default 0,
		THAY_DAU_VI_SAI  			INTEGER default 0,
		THAY_LOC_GIO_GIAN_LANH  	INTEGER default 0,
		THAY_DAU_TRO_LUC_LAI  		INTEGER default 0,
		BAO_DUONG_KHAC  			INTEGER default 0, 
		DATE_DATA    	  			INTEGER default 0, 
		CONSTRAINT PRIMARY KEY(MA_LOAI_XE)
) ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
 
	CREATE TABLE CHUKY_DANGKIEM
 ( 
		MA_KYHAN_DANGKIEM    				INTEGER(10) NOT NULL AUTO_INCREMENT, 
		TEN_KYHAN   						VARCHAR(200),
		CHU_KY_DAU       					INTEGER, 
		CHU_KY      						INTEGER, 
		CONSTRAINT PRIMARY KEY(MA_KYHAN_DANGKIEM)
)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;	
 	

CREATE TABLE PHUONGTIEN_GIAOTHONG
 ( 
		MA_PHUONGTIEN_GIAOTHONG 			VARCHAR (20),
		TEN_PHUONGTIEN_GIAOTHONG  			VARCHAR(200),
		LOAI_PHUONGTIEN_GIAOTHONG 			INTEGER(5) NOT NULL,
		MA_LOAI_XE   		 				INTEGER(10),
		BIENSO 		 						VARCHAR(40) NOT NULL,
		SOKHUNG 		 					VARCHAR(40) UNIQUE NOT NULL,
		SOMAY 		 						VARCHAR(40) UNIQUE NOT NULL,
		SO_KM_XE 	 						INTEGER(20) NOT NULL,
		THOIHAN_DANGKIEM 					DATE NOT NULL,
		MA_TAISAN  							INTEGER(15) NOT NULL,
		XANG_DAU  							BOOLEAN,
		MA_KYHAN_DANGKIEM    				INTEGER(10),
		CONSTRAINT FOREIGN KEY (MA_KYHAN_DANGKIEM) REFERENCES CHUKY_DANGKIEM(MA_KYHAN_DANGKIEM),
		CONSTRAINT FOREIGN KEY (MA_LOAI_XE) REFERENCES LOAI_XE(MA_LOAI_XE),
		CONSTRAINT FOREIGN KEY (MA_TAISAN) REFERENCES TAISAN(MA_TAISAN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT PRIMARY KEY(MA_PHUONGTIEN_GIAOTHONG)
 )ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
 
 
CREATE TABLE VUKHI_DAN_VATLIEUNO
 ( 
		MA_VUKHI_DAN_VATLIEUNO 			VARCHAR (20) NOT NULL,
		LOAI_VUKHI_DAN_VATLIEUNO  			INTEGER(5) NOT NULL, 
		DONG_VUKHI  		 					VARCHAR(40),
		SO_GIAYPHEPSUDUNG  					VARCHAR(40) NOT NULL,
		MA_TAISAN   							INTEGER(15) NOT NULL,
		CONSTRAINT FOREIGN KEY (MA_TAISAN) REFERENCES TAISAN(MA_TAISAN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT PRIMARY KEY(MA_VUKHI_DAN_VATLIEUNO)
 )ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;

 
CREATE TABLE NGUOIDUNG
 ( 
		TEN_TAI_KHOAN 			VARCHAR(20) NOT NULL,
		 MAT_KHAU 				VARCHAR(20) NOT NULL,
		 TEN_CAN_BO 				VARCHAR(30),
		 GIOI_THIEU 			VARCHAR(240),
		 TRANG_THAI_DANG_NHAP 	BOOLEAN DEFAULT FALSE,
		 MA_PHONGBAN 			INTEGER(10),
		 CONSTRAINT PRIMARY KEY(TEN_TAI_KHOAN),
 CONSTRAINT FOREIGN KEY (MA_PHONGBAN) REFERENCES PHONGBAN(MA_PHONGBAN)
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;


CREATE TABLE LENH_DIEU_XE
 ( 
		MA_LENH_DIEU_XE	 					INTEGER (20) NOT NULL AUTO_INCREMENT,
		MA_PHUONGTIEN_GIAOTHONG  			VARCHAR (20) NOT NULL, 
		TEN_TAI_KHOAN  	 					VARCHAR(20) NOT NULL,
		DIEM_XUATPHAT  	 					VARCHAR(200),
		DIEM_DEN  	 	 					VARCHAR(200), 
		NGAY_DI  	 	 					DATETIME, 
		NGAY_VE 	 						DATETIME,
		SO_KM_HIENTAI	 					INTEGER (30) NOT NULL,
		TON_NHIENLIEU_HIENTAI     			INTEGER,
		QUANG_DUONG_DUKIEN  				INTEGER (10),
		PHIEU_NHIENLIEU_DUOCCAP  			INTEGER (10),   
		PHIEU_NHIENLIEU_MUANGOAI  			INTEGER (10),   
		DIADIEM_GIODON 		 				VARCHAR(200),
		NOIDUNG_CHUYENDI 					VARCHAR(400), 
		NGUOI_TAO_LENH     	 				VARCHAR(20), 
		HUY_LENH   						 	BOOLEAN DEFAULT TRUE, 
		CONSTRAINT FOREIGN KEY (MA_PHUONGTIEN_GIAOTHONG) REFERENCES PHUONGTIEN_GIAOTHONG(MA_PHUONGTIEN_GIAOTHONG) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (TEN_TAI_KHOAN) REFERENCES NGUOIDUNG(TEN_TAI_KHOAN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (NGUOI_TAO_LENH) REFERENCES NGUOIDUNG(TEN_TAI_KHOAN)  ON DELETE SET NULL,
		CONSTRAINT PRIMARY KEY(MA_LENH_DIEU_XE)
 )ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
  
 
	CREATE TABLE DOT_THUCHIEN_DANGKIEM
 ( 
		MA_DOT_THUCHIEN_DANGKIEM     			INTEGER(10) NOT NULL AUTO_INCREMENT, 
		NGAY_THUCHIEN     						DATE,
		MA_TAPHOSO       						INTEGER, 
		MA_PHUONGTIEN_GIAOTHONG        			VARCHAR (20),
		GHI_CHU      							VARCHAR(400), 
		CONSTRAINT FOREIGN KEY (MA_PHUONGTIEN_GIAOTHONG) REFERENCES PHUONGTIEN_GIAOTHONG(MA_PHUONGTIEN_GIAOTHONG),
		CONSTRAINT PRIMARY KEY(MA_DOT_THUCHIEN_DANGKIEM)
)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;	
 	
CREATE TABLE NGUONGIAM
	( 
		MA_NGUONGIAM 			INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_NGUONGIAM 			VARCHAR(100),
		GIOI_THIEU 				VARCHAR(240),
		LIEN_HE 				VARCHAR(100),
		CONSTRAINT PRIMARY KEY(MA_NGUONGIAM)
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	CREATE TABLE DE_XUAT
	( 
		MA_DE_XUAT 							INTEGER(10) NOT NULL AUTO_INCREMENT,
		SODEXUAT 							VARCHAR(200),
		NGAYTHANG_VANBAN 					DATE,
		MA_PHONGBAN 						INTEGER(10),
		THOI_DIEM_BAT_DAU 					DATE NOT NULL, 
		THOI_DIEM_CHUYEN_GIAO 				DATE,
		THOI_DIEM_HOAN_THANH 				DATE,
		GHI_CHU 							VARCHAR(200),
		TEN_TAI_KHOAN 						VARCHAR(20) , 
		MA_TAPHOSO 							INTEGER DEFAULT NULL,
		CONSTRAINT FOREIGN KEY (MA_TAPHOSO) REFERENCES TAPHOSO(MA_TAPHOSO) ON DELETE SET NULL,
		CONSTRAINT FOREIGN KEY (MA_PHONGBAN) REFERENCES PHONGBAN(MA_PHONGBAN),
		CONSTRAINT PRIMARY KEY(MA_DE_XUAT) 

	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
 
CREATE TABLE QUATRINH_DEXUAT_THUCHIEN
	( 
		MA_QUATRINH_DEXUAT_THUCHIEN 		INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_QUA_TRINH 						VARCHAR(250),  
		MA_DE_XUAT 							INTEGER(10) NOT NULL,
		CONSTRAINT PRIMARY KEY(MA_QUATRINH_DEXUAT_THUCHIEN),
		CONSTRAINT FOREIGN KEY (MA_DE_XUAT) REFERENCES DE_XUAT(MA_DE_XUAT) ON DELETE CASCADE ON UPDATE CASCADE
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
CREATE TABLE DOT_THUCHIEN_GIAM_TAISAN
 ( 
		MA_DOT_GIAM 						INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_DOT_GIAM 						VARCHAR(100),
		LY_DO_GIAM 							INTEGER(4), 
		MO_TA 								VARCHAR(240),
		MA_QUATRINH_DEXUAT_THUCHIEN 		INTEGER(10) UNIQUE,
		MA_NGUONGIAM 						INTEGER(10),
		CONSTRAINT FOREIGN KEY (MA_QUATRINH_DEXUAT_THUCHIEN) REFERENCES QUATRINH_DEXUAT_THUCHIEN(MA_QUATRINH_DEXUAT_THUCHIEN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (MA_NGUONGIAM) REFERENCES NGUONGIAM(MA_NGUONGIAM),
		CONSTRAINT PRIMARY KEY(MA_DOT_GIAM)
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;

CREATE TABLE NGUONTANG
 ( 
		MA_NGUONTANG 			INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_NGUONTANG 			VARCHAR(100),
		GIOI_THIEU 				VARCHAR(240),
		LIEN_HE 				VARCHAR(100),
		CONSTRAINT PRIMARY KEY(MA_NGUONTANG)
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	
CREATE TABLE QUATRINH_NGHIEMTHU_QUYETTOAN
	( 
		MA_QUATRINH_NGHIEMTHU_QUYETTOAN 	INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_QUA_TRINH 						VARCHAR(100),  
		CONSTRAINT PRIMARY KEY(MA_QUATRINH_NGHIEMTHU_QUYETTOAN)
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	
	CREATE TABLE DOT_THUCHIEN_TANG_TAISAN
	(
		MA_DOT_TANG 							INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_DOT_TANG 							VARCHAR(100),
		LY_DO_TANG 								INTEGER(4), 
		MUC_KINH_PHI 							INTEGER(4), 
		MO_TA 									VARCHAR(240),
		MA_QUATRINH_DEXUAT_THUCHIEN 			INTEGER(10) UNIQUE,
		MA_QUATRINH_NGHIEMTHU_QUYETTOAN 		INTEGER(10) UNIQUE,
		MA_NGUONTANG 							INTEGER(10),
		CONSTRAINT FOREIGN KEY (MA_QUATRINH_DEXUAT_THUCHIEN) REFERENCES QUATRINH_DEXUAT_THUCHIEN(MA_QUATRINH_DEXUAT_THUCHIEN)  ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (MA_QUATRINH_NGHIEMTHU_QUYETTOAN) REFERENCES QUATRINH_NGHIEMTHU_QUYETTOAN(MA_QUATRINH_NGHIEMTHU_QUYETTOAN)  ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (MA_NGUONTANG) REFERENCES NGUONTANG(MA_NGUONTANG),
		CONSTRAINT PRIMARY KEY(MA_DOT_TANG)
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	CREATE TABLE TAISAN_DOT_THUCHIEN_TANG_TAISAN
	(
		MA_TAISAN 					INTEGER(10) NOT NULL,
		MA_DOT_TANG 				INTEGER(10) NOT NULL,
		CONSTRAINT PRIMARY KEY(MA_TAISAN,MA_DOT_TANG), 
		CONSTRAINT FOREIGN KEY (MA_TAISAN) REFERENCES TAISAN(MA_TAISAN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (MA_DOT_TANG) REFERENCES DOT_THUCHIEN_TANG_TAISAN(MA_DOT_TANG) ON DELETE CASCADE ON UPDATE CASCADE
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	
	CREATE TABLE TAISAN_DOT_THUCHIEN_GIAM_TAISAN
	( 
		MA_TAISAN 				INTEGER(10) NOT NULL, 
		MA_DOT_GIAM 			INTEGER(10) NOT NULL,
		CONSTRAINT PRIMARY KEY(MA_TAISAN,MA_DOT_GIAM),
		CONSTRAINT FOREIGN KEY (MA_TAISAN) REFERENCES TAISAN(MA_TAISAN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (MA_DOT_GIAM) REFERENCES DOT_THUCHIEN_GIAM_TAISAN(MA_DOT_GIAM) ON DELETE CASCADE ON UPDATE CASCADE

	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;

	
CREATE TABLE NGUONSUACHUA_BAODUONG
 ( 
		MA_NGUONSUACHUA_BAODUONG  			INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_NGUONSUACHUA_BAODUONG   			VARCHAR(100),
		GIOI_THIEU   						VARCHAR(240),
		LIEN_HE   							VARCHAR(100),
		SUACHUA_OR_BAODUONG 					INTEGER(2) DEFAULT 1,
		CONSTRAINT PRIMARY KEY(MA_NGUONSUACHUA_BAODUONG)
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	
CREATE TABLE DOT_THUCHIEN_SUACHUA_BAODUONG
 ( 
		MA_DOT_THUCHIEN_SUACHUA_BAODUONG 			INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_DOT_THUCHIEN_SUACHUA_BAODUONG 			VARCHAR(100), 
		SUACHUA_BAODUONG 							INTEGER(4), 
		LOAI_PHUONG_TIEN 							INTEGER(3) NOT NULL,
		MUC_KINH_PHI 								INTEGER(4), 
		MO_TA  										VARCHAR(240), 
		MA_QUATRINH_DEXUAT_THUCHIEN  				INTEGER(10) UNIQUE, 
		MA_QUATRINH_NGHIEMTHU_QUYETTOAN  			INTEGER(10) UNIQUE, 
		MA_NGUONSUACHUA_BAODUONG  					INTEGER(10), 
		CONSTRAINT FOREIGN KEY (MA_QUATRINH_DEXUAT_THUCHIEN) REFERENCES QUATRINH_DEXUAT_THUCHIEN(MA_QUATRINH_DEXUAT_THUCHIEN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (MA_QUATRINH_NGHIEMTHU_QUYETTOAN) REFERENCES QUATRINH_NGHIEMTHU_QUYETTOAN(MA_QUATRINH_NGHIEMTHU_QUYETTOAN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (MA_NGUONSUACHUA_BAODUONG) REFERENCES NGUONSUACHUA_BAODUONG(MA_NGUONSUACHUA_BAODUONG),
		CONSTRAINT PRIMARY KEY(MA_DOT_THUCHIEN_SUACHUA_BAODUONG)
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;

	CREATE TABLE DOT_THUCHIEN_SUACHUA_BAODUONG_TAISAN
 ( 
		MA_TAISAN 					INTEGER(10) NOT NULL, 
		MA_DOT_THUCHIEN_SUACHUA_BAODUONG 	INTEGER(10) NOT NULL, 
		THAY_NHOT 					BOOLEAN  not null default FALSE,
		THAY_LOC_NHOT 				BOOLEAN  not null default FALSE,
		THAY_LOC_GIO 				BOOLEAN  not null default FALSE,
		THAY_LOC_NHIEN_LIEU  		BOOLEAN  not null default FALSE,
		THAY_DAU_PHANH_DAU_LY_HOP  	BOOLEAN  not null default FALSE,
		THAY_DAU_HOP_SO  			BOOLEAN  not null default FALSE,
		THAY_DAU_VI_SAI  			BOOLEAN  not null default FALSE,
		THAY_LOC_GIO_GIAN_LANH  	BOOLEAN  not null default FALSE,
		THAY_DAU_TRO_LUC_LAI  		BOOLEAN  not null default FALSE,
		BAO_DUONG_KHAC  			BOOLEAN  not null default FALSE,
		CONSTRAINT PRIMARY KEY(MA_TAISAN,MA_DOT_THUCHIEN_SUACHUA_BAODUONG),
		CONSTRAINT FOREIGN KEY (MA_TAISAN) REFERENCES TAISAN(MA_TAISAN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (MA_DOT_THUCHIEN_SUACHUA_BAODUONG) REFERENCES DOT_THUCHIEN_SUACHUA_BAODUONG(MA_DOT_THUCHIEN_SUACHUA_BAODUONG) ON DELETE CASCADE ON UPDATE CASCADE
		 
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	CREATE TABLE GIAI_DOAN_THUC_HIEN
	( 
		MA_GIAI_DOAN_THUC_HIEN 				INTEGER(10) NOT NULL AUTO_INCREMENT,
		THOI_DIEM_BAT_DAU 					DATE,
		THOI_GIAN_DU_KIEN_HOAN_THANH 		INTEGER(3),
		THOI_DIEM_CHUYEN_GIAO 				DATE,
		THOI_DIEM_HOAN_THANH 				DATE,
		GHI_CHU 							VARCHAR(200),
		MA_QUATRINH_DEXUAT_THUCHIEN 		INTEGER(10) UNIQUE, 
		CONSTRAINT PRIMARY KEY(MA_GIAI_DOAN_THUC_HIEN),
		CONSTRAINT FOREIGN KEY (MA_QUATRINH_DEXUAT_THUCHIEN) REFERENCES QUATRINH_DEXUAT_THUCHIEN(MA_QUATRINH_DEXUAT_THUCHIEN) ON DELETE CASCADE ON UPDATE CASCADE
		 
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	
	CREATE TABLE GIAI_DOAN_THUC_HIEN_CAN_BO
	( 
		MA_GIAI_DOAN_THUC_HIEN  				INTEGER(10) NOT NULL, 
		TEN_TAI_KHOAN  						VARCHAR(20) NOT NULL,
		GIAO_NHANVIEC 						BOOLEAN NOT NULL DEFAULT FALSE,
		NGAY_THAM_GIA 						DATE NOT NULL,
		MA_TAPHOSO 							INTEGER DEFAULT NULL,  
		CONSTRAINT PRIMARY KEY(MA_GIAI_DOAN_THUC_HIEN,TEN_TAI_KHOAN),
		CONSTRAINT FOREIGN KEY (MA_TAPHOSO) REFERENCES TAPHOSO(MA_TAPHOSO) ON DELETE SET NULL,
		CONSTRAINT FOREIGN KEY (MA_GIAI_DOAN_THUC_HIEN) REFERENCES GIAI_DOAN_THUC_HIEN(MA_GIAI_DOAN_THUC_HIEN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (TEN_TAI_KHOAN) REFERENCES NGUOIDUNG(TEN_TAI_KHOAN) ON DELETE CASCADE ON UPDATE CASCADE
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	
	CREATE TABLE GIAI_DOAN_NGHIEM_THU
	( 
		MA_GIAI_DOAN_NGHIEM_THU 			INTEGER(10) NOT NULL AUTO_INCREMENT,
		THOI_DIEM_TIEP_NHAN 				DATE,
		THOI_GIAN_DU_KIEN_HOAN_THANH 		INTEGER(3),
		THOI_DIEM_CHUYEN_GIAO 				DATE,
		THOI_DIEM_KET_THUC	 				DATE,
		GHI_CHU 							VARCHAR(200),
		MA_QUATRINH_NGHIEMTHU_QUYETTOAN 	INTEGER(10) NOT NULL,
		CONSTRAINT PRIMARY KEY(MA_GIAI_DOAN_NGHIEM_THU),
		CONSTRAINT FOREIGN KEY (MA_QUATRINH_NGHIEMTHU_QUYETTOAN) REFERENCES QUATRINH_NGHIEMTHU_QUYETTOAN(MA_QUATRINH_NGHIEMTHU_QUYETTOAN)  ON DELETE CASCADE ON UPDATE CASCADE
		 
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	
	CREATE TABLE GIAI_DOAN_NGHIEM_THU_CAN_BO
	( 
		MA_GIAI_DOAN_NGHIEM_THU  			INTEGER(10) NOT NULL,
		TEN_TAI_KHOAN  						VARCHAR(20),
		GIAO_NHANVIEC 						BOOLEAN NOT NULL DEFAULT FALSE,
		NGAY_THAM_GIA 						DATE NOT NULL,
		MA_TAPHOSO 							INTEGER DEFAULT NULL,  
		CONSTRAINT PRIMARY KEY(MA_GIAI_DOAN_NGHIEM_THU,TEN_TAI_KHOAN),
		CONSTRAINT FOREIGN KEY (MA_TAPHOSO) REFERENCES TAPHOSO(MA_TAPHOSO) ON DELETE SET NULL,
		CONSTRAINT FOREIGN KEY (MA_GIAI_DOAN_NGHIEM_THU) REFERENCES GIAI_DOAN_NGHIEM_THU(MA_GIAI_DOAN_NGHIEM_THU) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (TEN_TAI_KHOAN) REFERENCES NGUOIDUNG(TEN_TAI_KHOAN) ON DELETE CASCADE ON UPDATE CASCADE
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	
	CREATE TABLE GIAI_DOAN_QUYET_TOAN
	( 
		MA_GIAI_DOAN_QUYET_TOAN 	 		INTEGER(10) NOT NULL AUTO_INCREMENT,
		THOI_DIEM_TIEP_NHAN 		 		DATE,
		THOI_GIAN_DU_KIEN_HOAN_THANH 	 	INT, 
		THOI_GIAN_KET_THUC 		 			DATE,
		GHI_CHU 				 			VARCHAR(240),
		MA_QUATRINH_NGHIEMTHU_QUYETTOAN  	INTEGER(10) NOT NULL,
		CONSTRAINT PRIMARY KEY(MA_GIAI_DOAN_QUYET_TOAN),
		CONSTRAINT FOREIGN KEY (MA_QUATRINH_NGHIEMTHU_QUYETTOAN) REFERENCES QUATRINH_NGHIEMTHU_QUYETTOAN(MA_QUATRINH_NGHIEMTHU_QUYETTOAN) ON DELETE CASCADE ON UPDATE CASCADE
		 
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
	CREATE TABLE GIAI_DOAN_QUYET_TOAN_CAN_BO
 ( 
		MA_GIAI_DOAN_QUYET_TOAN  			INTEGER(10) NOT NULL,
		TEN_TAI_KHOAN  						VARCHAR(20),
		GIAO_NHANVIEC 						BOOLEAN NOT NULL DEFAULT FALSE,
		NGAY_THAM_GIA 						DATE NOT NULL,
		MA_TAPHOSO	 						INTEGER DEFAULT NULL,  
		CONSTRAINT PRIMARY KEY(MA_GIAI_DOAN_QUYET_TOAN,TEN_TAI_KHOAN),
		CONSTRAINT FOREIGN KEY (MA_TAPHOSO) REFERENCES TAPHOSO(MA_TAPHOSO) ON DELETE SET NULL,
		CONSTRAINT FOREIGN KEY (MA_GIAI_DOAN_QUYET_TOAN) REFERENCES GIAI_DOAN_QUYET_TOAN(MA_GIAI_DOAN_QUYET_TOAN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (TEN_TAI_KHOAN) REFERENCES NGUOIDUNG(TEN_TAI_KHOAN) ON DELETE CASCADE ON UPDATE CASCADE
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;
	
		CREATE TABLE THONGBAO
 ( 
		MA_THONGBAO  						INTEGER(10) NOT NULL AUTO_INCREMENT,
		LOAI_THONGBAO   					INTEGER(4) NOT NULL,
		TEN_TAI_KHOAN_GUI  					VARCHAR(20),
		NGUON_TACDONG    					VARCHAR(200),
		NGUON_BITACDONG      				VARCHAR(200), 
		NOIDUNG_THONGBAO   					VARCHAR(500) NOT NULL,  
		NGAY_THONGBAO   					DATETIME  NOT NULL,
		CONSTRAINT FOREIGN KEY (NGUON_TACDONG) REFERENCES NGUOIDUNG(TEN_TAI_KHOAN) ON DELETE CASCADE ON UPDATE CASCADE, 
		CONSTRAINT FOREIGN KEY (TEN_TAI_KHOAN_GUI) REFERENCES NGUOIDUNG(TEN_TAI_KHOAN) ON DELETE CASCADE ON UPDATE CASCADE, 
		CONSTRAINT PRIMARY KEY(MA_THONGBAO)
)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;	
	
	CREATE TABLE NGUOIDUNG_NHAN_THONGBAO
 ( 
		MA_THONGBAO  						INTEGER(10) NOT NULL,
		TEN_TAI_KHOAN  						VARCHAR(20),
		NGAY_DOC_THONGBAO  					DATETIME ,
		CONSTRAINT PRIMARY KEY(MA_THONGBAO, TEN_TAI_KHOAN),
		CONSTRAINT FOREIGN KEY (MA_THONGBAO) REFERENCES THONGBAO(MA_THONGBAO) ON DELETE CASCADE ON UPDATE CASCADE, 
		CONSTRAINT FOREIGN KEY (TEN_TAI_KHOAN) REFERENCES NGUOIDUNG(TEN_TAI_KHOAN) ON DELETE CASCADE ON UPDATE CASCADE
)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;	

	CREATE TABLE KY_HAN_THONGKE_XANG_DAU
 ( 
		MA_KYHAN    						INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_KYHAN   						VARCHAR(100),
		NGAY_BAT_DAU    					DATE,
		NGAY_KET_THUC    					DATE,
		GHI_CHU   							VARCHAR(400),
		CONSTRAINT PRIMARY KEY(MA_KYHAN)
)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;	
 	
	CREATE TABLE SYSTEM_LOG
 ( 
		LOG_ID   							INTEGER(10) NOT NULL AUTO_INCREMENT,
		TEN_TAI_KHOAN      					VARCHAR(50), 
		NOIDUNG      						VARCHAR(500),
		THOIGIAN          					DATETIME, 
		CONSTRAINT PRIMARY KEY(LOG_ID)
)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;	
 	
	CREATE TABLE ROLE
	( 
		MA_QUYEN 					INTEGER NOT NULL AUTO_INCREMENT,
		CONSTRAINT PRIMARY KEY(MA_QUYEN),
		TEN_QUYEN 					VARCHAR(150) NOT NULL,
		MO_TA 						VARCHAR(250),
		THEM_NGUOIDUNG 				BOOLEAN DEFAULT FALSE,
		PHAN_QUYEN_NGUOIDUNG 		BOOLEAN DEFAULT FALSE,
		XEM_THONGTIN_NGUOIDUNG 		BOOLEAN DEFAULT FALSE,
		XOA_NGUOIDUNG 				BOOLEAN DEFAULT FALSE,
		THEM_THONGTIN_TAISAN 	 	BOOLEAN DEFAULT FALSE,
		XEM_THONGTIN_TAISAN 		BOOLEAN DEFAULT FALSE,
		SUA_THONGTIN_TAISAN 		BOOLEAN DEFAULT FALSE,
		XOA_THONGTIN_TAISAN 		BOOLEAN DEFAULT FALSE,
		THEM_CONGVIEC 				BOOLEAN DEFAULT FALSE,
		XEM_THONGTIN_CONGVIEC 		BOOLEAN DEFAULT FALSE,
		SUA_THONGTIN_CONGVIEC 		BOOLEAN DEFAULT FALSE,
		XOA_CONGVIEC 			 	BOOLEAN DEFAULT FALSE,
		THEM_HOSO 				 	BOOLEAN DEFAULT FALSE,
		XEM_THONGTIN_HOSO 		 	BOOLEAN DEFAULT FALSE,
		SUA_THONGTIN_HOSO 		 	BOOLEAN DEFAULT FALSE,
		XOA_HOSO 				 	BOOLEAN DEFAULT FALSE
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;

	CREATE TABLE ROLE_CAN_BO
	( 
		MA_QUYEN  					INTEGER(10) NOT NULL,
		TEN_TAI_KHOAN  				VARCHAR(20) NOT NULL,
		CONSTRAINT 	PRIMARY KEY(MA_QUYEN,TEN_TAI_KHOAN),
		CONSTRAINT FOREIGN KEY (MA_QUYEN) REFERENCES ROLE(MA_QUYEN) ON DELETE CASCADE ON UPDATE CASCADE,
		CONSTRAINT FOREIGN KEY (TEN_TAI_KHOAN) REFERENCES NGUOIDUNG(TEN_TAI_KHOAN)  ON DELETE CASCADE ON UPDATE CASCADE
	)ENGINE= INNODB CHARACTER SET UTF8 COLLATE UTF8_UNICODE_CI;


 GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' IDENTIFIED BY PASSWORD '*[blabla]' WITH GRANT OPTION